// Program management schema
// This file contains models for programs, program periods, and related entities

model Program {
  id           String   @id @default(cuid())
  title        String
  description  String
  targetAmount Decimal  @map("target_amount") @db.Decimal(15, 2)
  bannerImage  String?  @map("banner_image")
  category     String?
  status       String   @default("draft") // 'draft', 'pending', 'active', 'paused', 'ended'
  programType  String   @default("one_time") @map("program_type") // 'one_time', 'multiple', 'selected_date'
  contact      String?
  details      String?  // Additional program details
  createdBy    String   @map("created_by")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  // Relations
  programPeriods ProgramPeriod[]
  donations      Donation[]

  @@map("programs")
}

model ProgramPeriod {
  id                    String    @id @default(cuid())
  programId             String    @map("program_id")
  startDate             DateTime  @map("start_date")
  endDate               DateTime  @map("end_date")
  cycleNumber           Int?      @map("cycle_number") // for recurring programs (1, 2, 3, etc.), null for one_time
  currentAmount         Decimal   @default(0) @map("current_amount") @db.Decimal(15, 2) // total donations received in this period
  
  // Recurring settings (only for recurring programs)
  recurringFrequency    String?   @map("recurring_frequency") // 'weekly', 'monthly', 'quarterly', 'yearly' (null for one_time)
  recurringDay          Int?      @map("recurring_day") // day of week (1-7) or day of month (1-31) (null for one_time)
  recurringDurationDays Int?      @map("recurring_duration_days") // how many days each activation lasts (null for one_time)
  totalCycles           Int?      @map("total_cycles") // null for indefinite, number for limited cycles (null for one_time)
  nextActivationDate    DateTime? @map("next_activation_date") // when the next period should be created
  
  createdAt             DateTime  @default(now()) @map("created_at")
  updatedAt             DateTime  @updatedAt @map("updated_at")

  // Relations
  program   Program   @relation(fields: [programId], references: [id], onDelete: Cascade)
  donations Donation[]

  @@map("program_periods")
}
